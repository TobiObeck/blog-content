# Preventing Background Click of Link-Wrapped Image with `:has()`

Oftentimes websites provide an option to enlarge images in a popup overlay with a JavaScript-based solution like lightbox. If you want to provide a [graceful fallback](https://www.roadmappy.com/maps/client/browser_compatibility) for users that don't run JavaScript (e.g. due to bad internet connection), you can do this:

**Wrap an an anchor tag around the image linking to the image URL!** Then a click on the image will open it in full screen. This is basically the same as right clicking the image and manually opening it in a new window. 

Here is an example:

```html
<a href="tobiobeck.com/favicon.png">
    <img src="tobiobeck.com/favicon.png" alt="Website's logo" />
</a>
```

However, my initial implementation had one problem. When the image is too small to fill the full width of the parent container, clicking on the empty space to the left or right of the image would trigger the link and enlarge the image. This feels weird and is especially problematic on mobile devices because swiping and scrolling through the content could accidentally trigger a click.

![Do you see how the mouse cursor has a pointer shape indicating something is clickable?](./imgs/problem_clicking_next_to_image_on_background_with_pointer.png)

Analyzing the problem source, we can see that the image tag (`<img />`) has a margin. The anchor tag (`<a>`) is wrapping around the image tag. So, it also **wraps around the margin and the space it occupies**. The margin becomes clickable, which we don't want.

![Alt text](./imgs/problem_image_margin2.png)

In my use case, changing the markup was not an option because the HTML code was generated by Markdown to HTML conversion process similar to a static site generator. But we can prevent the issue without adding additional HTML elements by removing the margin from the image tag (`<img />`) and instead applying it to the wrapping anchor `<a>` tag. Naively applying a horizontal margin to all anchors would be bad because it would butcher normal links in prose text. Therefore, the handy [pseudo-class `:has()`](https://developer.mozilla.org/en-US/docs/Web/CSS/:has) can be used.

 `margin: auto;` Because applying a margin

Before I show that, let's first establish some common ground with the following example code. We have 4 text paragraphs that contain some links. The latter two paragraphs contain an image.

The solution is to make the image `display: block`.

```css
.container a:has(img) {
    display: block;
    margin: auto;
    max-width: fit-content;
}
```

```html
<div class="container">
    <p>
        vc-hype ipsum dolor <a target="_blank" href="https://google.com">some link</a> sit AI in sports consectetur adipiscing elit.
    </p>
    <p>
        <u>some paragraph child</u> vc-hype ipsum dolor <a target="_blank" href="https://google.com">another link</a> sit AI in sports consectetur adipiscing elit. data pipelines cognitive science specialized (CSS) neural networks (NN).
    </p>
    <p>
        <a target="_blank" href="https://picsum.photos/200/100">
            <img src="https://picsum.photos/200/100" alt="Here's some alt text." />
        </a>
    </p>
    <p>
        <a target="_blank" href="https://tobiobeck.com/favicon.png">
            <img src="https://tobiobeck.com/favicon.png" alt="Here is some more alt text." />
        </a>
    </p>
</div>
```

```css
body, p {
    margin: 0;
}

.container {
    width: 300px;
    background-color: #ebf4f7;
}

.container p {            
    padding: 0.5rem;
    text-align: justify;
}

.container img {
    display: block;
    margin: 0 auto;
    background-color: #eee;
}
```
